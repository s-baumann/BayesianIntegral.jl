<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2.0 Training Hyperparameters · BayesianIntegral</title><meta name="title" content="2.0 Training Hyperparameters · BayesianIntegral"/><meta property="og:title" content="2.0 Training Hyperparameters · BayesianIntegral"/><meta property="twitter:title" content="2.0 Training Hyperparameters · BayesianIntegral"/><meta name="description" content="Documentation for BayesianIntegral."/><meta property="og:description" content="Documentation for BayesianIntegral."/><meta property="twitter:description" content="Documentation for BayesianIntegral."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesianIntegral</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">BayesianIntegral</a></li><li><a class="tocitem" href="../1_bayesian_integration/">1.0 Bayesian Integration</a></li><li class="is-active"><a class="tocitem" href>2.0 Training Hyperparameters</a><ul class="internal"><li><a class="tocitem" href="#2.1-Maximum-Likelihood-with-Stochastic-Gradient-Descent"><span>2.1 Maximum Likelihood with Stochastic Gradient Descent</span></a></li><li><a class="tocitem" href="#2.2-RProp"><span>2.2 RProp</span></a></li></ul></li><li><a class="tocitem" href="../3_api_reference/">3.0 API Reference</a></li><li><a class="tocitem" href="../99_refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>2.0 Training Hyperparameters</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2.0 Training Hyperparameters</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/s-baumann/BayesianIntegral.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/s-baumann/BayesianIntegral.jl/blob/master/docs/src/2_training_hyperparameters.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="2.0-Training-Hyperparameters"><a class="docs-heading-anchor" href="#2.0-Training-Hyperparameters">2.0 Training Hyperparameters</a><a id="2.0-Training-Hyperparameters-1"></a><a class="docs-heading-anchor-permalink" href="#2.0-Training-Hyperparameters" title="Permalink"></a></h1><p>This package currently supports two ways of training hyperparameters. The first is Maximum likelihood with stochastic gradient descent while the second uses a momentum based algorithm to maximise likelihood (Blum and Riedmiller 2013).</p><h2 id="2.1-Maximum-Likelihood-with-Stochastic-Gradient-Descent"><a class="docs-heading-anchor" href="#2.1-Maximum-Likelihood-with-Stochastic-Gradient-Descent">2.1 Maximum Likelihood with Stochastic Gradient Descent</a><a id="2.1-Maximum-Likelihood-with-Stochastic-Gradient-Descent-1"></a><a class="docs-heading-anchor-permalink" href="#2.1-Maximum-Likelihood-with-Stochastic-Gradient-Descent" title="Permalink"></a></h2><p>This is done by the <code>calibrate_by_ML_with_SGD</code> function. The procedure is:</p><ul><li>Extract a sample of the requested size from the dataset. Sampling is done without replacement (or else the K matrix is singular and not invertible)</li><li>Find the likelihood of the dataset given the input hyperparameters. Also find the marginal likelihood (with respect to all hyperparameters) and use the Newtonian method to suggest another set of hyperparameters. The step to the new parameter set (as chosen by the Newtonian method) can be adjusted by the step_multiple parameter.</li></ul><p>This process continues for a user-specifiable number of iterates.</p><p>Note that using stochastic gradient descent is important here as the major time here is in inverting an <span>$N$</span>x<span>$N$</span> matrix which has a complexity of about <span>$O(N^{2.3})$</span>. Thus if only 10% of observations are used in each iterate this makes the calibration more than 100 times faster than using all observations.</p><p>This function can be used in the following way:</p><pre><code class="nohighlight hljs">old_cov_func_parameters = GaussianKernelHyperparameters(1.0, repeat([10.0] , outer = dims))
steps = 100                           # How many optimisation steps
batch_size = 5                        # Number of observations per sample
step_multiple = 1.0                   # How far to step
noise = 0.001                         # Noise parameter
twister = MersenneTwister(2)          # Random number generator
new_cov_func_parameters = calibrate_by_ML_with_SGD(X, y, old_cov_func_parameters, steps, batch_size, step_multiple, noise, twister)</code></pre><h2 id="2.2-RProp"><a class="docs-heading-anchor" href="#2.2-RProp">2.2 RProp</a><a id="2.2-RProp-1"></a><a class="docs-heading-anchor-permalink" href="#2.2-RProp" title="Permalink"></a></h2><p>This technique also maximises Maximum Likelihood. The main difference is that rather than taking Newtonian steps towards an maximum, the Rprop algorithm ignores the magnitude of the marginal likelihood and looks only at the sign. It moves a small distance uphill towards a higher likelihood. If the slope is still positive at this new point it will speed up and step by a greater amount in this direction. If the sign of the gradient ever changes it will slow down. It is thus a momentum based optimiser.</p><p>This is implemented with the <code>calibrate_by_ML_with_Rprop</code> function as below:</p><pre><code class="nohighlight hljs">old_cov_func_parameters = GaussianKernelHyperparameters(1.0, repeat([10.0] , outer = dims))
params  = RProp_params()                             # parameters for the RProp algorithm.
noise = 0.001                                        # Noise parameter
MaxIter = 2000                                       # Number of steps
new_cov_func_parameters = calibrate_by_ML_with_Rprop(X, y, old_cov_func_parameters, MaxIter, noise, params)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1_bayesian_integration/">« 1.0 Bayesian Integration</a><a class="docs-footer-nextpage" href="../3_api_reference/">3.0 API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 9 February 2026 05:29">Monday 9 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
