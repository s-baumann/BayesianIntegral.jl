<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>2.0 Training Hyperparameters · BayesianIntegral</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesianIntegral</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">BayesianIntegral</a></li><li><a class="tocitem" href="../1_bayesian_integration/">1.0 Bayesian Integration</a></li><li class="is-active"><a class="tocitem" href>2.0 Training Hyperparameters</a><ul class="internal"><li><a class="tocitem" href="#.1-Maximum-Likelihood-with-Stochastic-Gradient-Descent"><span>2.1 Maximum Likelihood with Stochastic Gradient Descent</span></a></li><li><a class="tocitem" href="#.2-RProp"><span>2.2 RProp</span></a></li></ul></li><li><a class="tocitem" href="../99_refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>2.0 Training Hyperparameters</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>2.0 Training Hyperparameters</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/s-baumann/BayesianIntegral.jl/blob/master/docs/src/2_training_hyperparameters.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id=".0-Training-Hyperparameters"><a class="docs-heading-anchor" href="#.0-Training-Hyperparameters">2.0 Training Hyperparameters</a><a id=".0-Training-Hyperparameters-1"></a><a class="docs-heading-anchor-permalink" href="#.0-Training-Hyperparameters" title="Permalink"></a></h1><p>This package currently supports two ways of training hyperparameters. The first is Maximum likelihood with stochastic gradient descent while the second uses a momentum based algorithm to maximise likelihood (Blum and Riedmiller 2013).</p><h2 id=".1-Maximum-Likelihood-with-Stochastic-Gradient-Descent"><a class="docs-heading-anchor" href="#.1-Maximum-Likelihood-with-Stochastic-Gradient-Descent">2.1 Maximum Likelihood with Stochastic Gradient Descent</a><a id=".1-Maximum-Likelihood-with-Stochastic-Gradient-Descent-1"></a><a class="docs-heading-anchor-permalink" href="#.1-Maximum-Likelihood-with-Stochastic-Gradient-Descent" title="Permalink"></a></h2><p>This is done by the calibrate_by_ML_with_SGD function. The procedure is:</p><ul><li>Extract a sample of the requested size from the dataset. Sampling is done without replacement (or else the K matrix is singular and not invertible)</li><li>Find the likelihood of the dataset given the input hyperparameters. Also find the marginal likelihood (with respect to all hyperparameters) and use the Newtonian method to suggest another set of hyperparameters. The step to the new parameter set (as chosen by the Newtonian method) can be adjusted by the step_multiple parameter.</li></ul><p>This process continues for a user-specifiable number of iterates.</p><p>Note that using stochastic gradient descent is important here as the major time here is in inverting an <span>$N$</span>x<span>$N$</span> matrix which has a complexity of about <span>$O(N^{2.3})$</span>. Thus if only 10% of observations are used in each iterate this makes the calibration more than 100 times faster than using all observations.</p><p>This function can be used in the following way:</p><pre><code class="nohighlight hljs">old_cov_func_parameters = gaussian_kernel_hyperparameters(1.0, repeat([10.0] , outer = dims))
steps = 100                           # How many optimisation steps
batch_size = 5                        # Number of observations per sample
step_multiple = 1.0                   # How far to step
noise = 0.001                         # Noise parameter
seed = 2                              # Random number seed (for gathering random samples)
new_cov_func_parameters = calibrate_by_ML_with_SGD(X, y, cov_func_parameters, steps, batch_size, step_multiple, noise, seed)</code></pre><h2 id=".2-RProp"><a class="docs-heading-anchor" href="#.2-RProp">2.2 RProp</a><a id=".2-RProp-1"></a><a class="docs-heading-anchor-permalink" href="#.2-RProp" title="Permalink"></a></h2><p>This technique also maximises Maximum Likelihood. The main difference is that rather than taking Newtonian steps towards an maximum, the Rprop algorithm ignores the magnitude of the marginal likelihood and looks only at the sign. It moves a small distance uphill towards a higher likelihood. If the slope is still positive at this new point it will speed up and step by a greater amount in this direction. If the sign of the gradient ever changes it will slow down. It is thus a momentum based optimiser.</p><p>This is implemented with the calibrate_by_ML_with_Rprop function as below:</p><pre><code class="nohighlight hljs">old_cov_func_parameters = gaussian_kernel_hyperparameters(1.0, repeat([10.0] , outer = dims))
params  = RProp_params(1.01,0.99,0.2,5.0,0.5)    # parameters for the RProp algorithm.
noise = 0.001                                    # Noise parameter
MaxIter = 2000                                   # Number of steps
new_cov_func_parameters = train_with_RProp(X, y, cov_func_parameters, MaxIter, noise, params)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1_bayesian_integration/">« 1.0 Bayesian Integration</a><a class="docs-footer-nextpage" href="../99_refs/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Thursday 19 August 2021 22:48">Thursday 19 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
